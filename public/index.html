<!doctype html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, width=device-width, height=device-height">
	<title>VOM(Voice Of Modernhouse)</title>
	<meta name="description" content="VOM">
	<link rel="stylesheet" href="css/reset.css">
	<link rel="stylesheet" href="css/styles.css">
	<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
	<script type="text/javascript" src="http://www.parsecdn.com/js/parse-1.2.18.min.js"></script>
	<script type="text/javascript" src="scroll/jquery.jscroll.min.js"></script>
	<script type="text/javascript" src="common.js"></script>
<!--	<script type="text/javascript" src="scroll/jscroll.jquery.json"></script>-->
</head>

<body>
	
	<div id="div_upper" style="z-index: -10">
		<img src="img/upper.png">
	</div>
	<div id="div_write"><a href="write.html">글쓰기</a></div>
	
	<div id="div_list">

	</div>
	<div id="div_serach">
		<select id="select_srcOption1" style="width: 60px; margin-left: 10px; height: 30px" onchange="chgOpt2()">
			<option value="Title">제목</option>
			<option value="Branch">지점</option>
			<option value="PU">부서</option>
		</select>
		<select id="select_srcOption2" style="width: 60px; margin-left: 10px; height: 30px"></select>
		<input id="input_srcWord" style="margin-left: 10px; width: 35%; height: 30px" type="text" placeholder="검색어 입력">
		<button style="margin-left: 10px; height: 30px" onclick="doSearch()">검색</button>
	</div>
	<script type="text/javascript">
		var mainDiv_pos;
		var device_width;
		
		function chgOpt2(){
			var opt1;
			opt1 = select_srcOption1.options[select_srcOption1.selectedIndex].value;
			document.getElementById("select_srcOption2").innerHTML = "";

			AddOption(opt1, 'select_srcOption2');
		}
		
		// 검색 버튼 눌렀을 때 호출
		function doSearch(){
			var src_optVal;	// 지점 혹은 부서 선택 옵션 변수
			var src_word;	// 검색어 변수
			
			if(select_srcOption1.options[select_srcOption1.selectedIndex].value != "t"){
				src_optVal = select_srcOption2.options[select_srcOption2.selectedIndex].innerHTML;
			} else{
				src_optVal = "";
			}
			
			src_word = document.getElementById("input_srcWord").value;
			alert("src_optVal : " + src_optVal + " / " + "src_word : " + src_word);
		}
		
		$(function(){
			mainDiv_pos = $('#div_upper').height();
			device_width = (window.innerWidth > 0) ? window.innerWidth : screen.width;
			
			$('#div_upper').css("width",device_width+"px");
			$('#div_list').css("top",mainDiv_pos+25+"px");
		});
	
		Parse.initialize("VlzoLnwwdwKUwvKFUPEKSadvZlL6SeVmPuRDy8ac", "fxEr0NEeRaD6rfs80NEO21t6efQm3FwHwgwaQPuH");

		//UpdateItem("x9lbF8Uuvp", "분당점", "선물", "건의사항", "자율출근제를 도입합시다!", true);
		//DeleteItem("x9lbF8Uuvp");
		
		
		var Item = Parse.Object.extend("BBS");
		var query = new Parse.Query(Item);
		var item;
		var strBranch;
		var strPU;
		var strTitle;
		var strContent;//사용 안 함
		var bPublic;//사용 안 함
		var date;
		
		var num_start;
		var num_end;
		var num_total;

		query.descending("createdAt");

		query.find({
			success: function(results) {
				
				num_total = results.length;
				num_start = 0;
				num_end = num_start + 10;
				
				for (var i = num_start; i < num_end; i++) { 
					item = results[i];
					strId = item.id;
					strBranch = item.get("Branch");
					strPU = item.get("PU");
					strTitle = item.get("Title");
					strContent = item.get("Content");//사용 안 함
					bPublic = item.get("Public");
					date = item.createdAt;

					$('#div_list').append("<a href='read.html?id=" + strId + "'>" + "<div style='width: 100%; border-bottom: 2px solid black; padding-top : 15px; padding-bottom: 15px'>"+
					"<div style='float: left; margin-left: 10px; background-color: #808080; width: 60px; height: 20px; color: white; font-weight: bolder; text-align: center; padding-top: 5px; border-radius: 5px; font-size: 13px'>"+strBranch+"</div>"
										+"<div style='float: left; margin-left: 30px; height: 30px; font-weight: bolder;'>" + strTitle + "</div>"
										+"<br><br><div style='float: left;  margin-left: 10px; margin-top: -10px; width: 60px; height: 30px; color: black; font-weight: bolder; text-align: center; font-size: 13px'>" + strPU + "</div>"
										+"<div style='float: right; margin-top: -10px; height: 30px; font-weight: bolder; font-size: 13px'>" +date.getFullYear() + '-' + (date.getMonth() + 1) + '-' + date.getDate() + "&nbsp&nbsp" + "</div>"
					+"</div>" + "</a>");
				}
					$('#div_list').append("<div class='next'><a href='page.html'>next</a></div>");
					$('#div_list').jscroll();
			},

			error: function(error) {
				// error is an instance of Parse.Error.
			}
		});
/*		
		Parse.Cloud.run('hello', {}, {
			success: function(result) {
				// result is 'Hello world!'
				//alert(result);
			},
			error: function(error) {
			}
		});
*/
		
		function nextPage(){
			location = "page.html?s="+num_start+"&e="+num_end;
			//http://192.168.137.1:8020/vom_ing/public/index.html
		}
	</script>
</body>

</html>
